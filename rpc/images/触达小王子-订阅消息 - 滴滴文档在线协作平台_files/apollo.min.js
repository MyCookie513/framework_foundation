!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):e.Apollo=o()}(this,function(){"use strict";var e="https://as.xiaojukeji.com/ep/as/feature";var o,t,n,r,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.keys||(Object.keys=(o=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("function"!=typeof e&&("object"!==(void 0===e?"undefined":a(e))||null===e))throw new TypeError("Object.keys called on non-object");var s,i,c=[];for(s in e)o.call(e,s)&&c.push(s);if(t)for(i=0;i<r;i++)o.call(e,n[i])&&c.push(n[i]);return c})),Array.prototype.forEach||(Array.prototype.forEach=function(e){var o,t;if(null==this)throw new TypeError("this is null or not defined");var n=Object(this),r=n.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(o=arguments[1]),t=0;t<r;){var a;t in n&&(a=n[t],e.call(o,a,t,n)),t++}});var s,i=function(){},c=[];return{getToggle:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if((o=o||{}).ns=o.ns||"service",o._t=(new Date).getTime(),o._source="jssdk",!o.name)return o.debug&&console.error("Apollo:: Not Found name"),t({code:3,data:{},message:"Apollo:: Not Found name"}),!1;if(!o.key)return o.debug&&console.error("Apollo:: Not Found key"),t({code:3,data:{},message:"Apollo:: Not Found key"}),!1;o.name&&"[object String]"===Object.prototype.toString.call(o.name)&&(o.name=[o.name]);var n=e;o.debug?n="http://astest.intra.xiaojukeji.com/ep/as/feature":!0===o.global?n="https://as.didiglobal.com/ep/as/feature":!1===o.global&&(n="https://as.xiaojukeji.com/ep/as/feature"),delete o.debug;var r=[];Object.keys(o).forEach(function(e){var t;o[e]&&("name"===e?o[e].forEach(function(o){t=encodeURIComponent(e)+"="+encodeURIComponent(o),r.push(t)}):(t=encodeURIComponent(e)+"="+encodeURIComponent(o[e]),r.push(t)))}),n+="?"+r.join("&");var a=!0,u=setTimeout(function(){a=!1,t({code:1,data:{},message:"Fetching timeout"})},o._timeout||5e3);!function(e,o){try{var t=new XMLHttpRequest;window.XDomainRequest&&(t=new window.XDomainRequest,0===window.location.href.indexOf("http://")&&0===e.indexOf("https://")&&(e=e.replace("https://","http://"))),t.open("GET",e,!0),t.onload=function(){if(t){var e=t.status,n=e>=200&&e<300||304===e,r=!("status"in t)&&t.responseText;if(n||r){var a=JSON.parse(t.responseText);o(null,a)}else o(new Error("fetch Error(status: "+e+")"));t=null}},t.onprogress=function(){},t.ontimeout=function(){},t.onerror=function(){o(new Error("Network Error")),t=null},t.send()}catch(e){window.console&&console.log(e)}}(n,function(e,n){var r={},i={code:0,data:{},message:"Success"};if(!a)return!1;clearTimeout(u),e||n.code?(i.code=2,i.message="Server response Error"):n.data.forEach(function(e){var t="",n={};e.assign&&(e.assign.args&&(n=e.assign.args),e.assign.testKey&&(t=e.assign.testKey));var a=!1,i=t.split(":").reverse();r[e.name]={isAllow:function(){if(!a&&e.allow){var n={name:e.name,testKey:t,conf:o};(function(e){s&&"function"==typeof s?s(e):c.push(e)})(n=function(e){return{apollo_testkey:e.testKey,apollo_allow:1,apollo_key:e.conf.key,apollo_ns:e.conf.ns,name:e.name}}(n)),a=!0}return e.allow},testKey:t,params:n,groupName:i.length>0?i[0]:""}}),i.data=r,t(i)})},setLogFn:function(e){s=e,c.forEach(function(e){s(e)}),c=[]},version:"1.0.5"}});
